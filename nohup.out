2024-04-19 17:47:45,887 - modelscope - INFO - PyTorch version 2.2.1 Found.
2024-04-19 17:47:45,889 - modelscope - INFO - Loading ast index from /root/.cache/modelscope/ast_indexer
2024-04-19 17:47:45,972 - modelscope - INFO - Loading done! Current index file version is 1.13.1, with md5 e717b8c8a8e6ab5196082f88c64bb48a and a total number of 972 components indexed
/mnt/VisDiff/visdiff/lib/python3.9/site-packages/transformers/utils/generic.py:311: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
2024-04-19 17:47:51,656 - modelscope - INFO - Use user-specified model revision: v1.0.0
Downloading:   0%|          | 0.00/14.4G [00:00<?, ?B/s]Downloading:   1%|          | 160M/14.4G [00:51<1:18:44, 3.23MB/s]Downloading:   2%|▏         | 320M/14.4G [00:53<33:33, 7.50MB/s]  Downloading:   3%|▎         | 480M/14.4G [00:54<18:27, 13.5MB/s]Downloading:   4%|▍         | 640M/14.4G [00:54<11:17, 21.8MB/s]Downloading:   4%|▍         | 640M/14.4G [01:09<11:17, 21.8MB/s]Downloading:   5%|▌         | 800M/14.4G [01:39<30:22, 8.01MB/s]Downloading:   7%|▋         | 960M/14.4G [01:46<23:12, 10.4MB/s]Downloading:   8%|▊         | 1.09G/14.4G [01:56<20:05, 11.8MB/s]Downloading:   9%|▊         | 1.25G/14.4G [02:10<19:51, 11.8MB/s]Downloading:  10%|▉         | 1.41G/14.4G [02:30<21:41, 10.7MB/s]Downloading:  11%|█         | 1.56G/14.4G [02:33<17:06, 13.4MB/s]Downloading:  12%|█▏        | 1.72G/14.4G [02:49<17:54, 12.7MB/s]Downloading:  13%|█▎        | 1.87G/14.4G [02:53<14:20, 15.6MB/s]Downloading:  13%|█▎        | 1.87G/14.4G [03:10<14:20, 15.6MB/s]Downloading:  14%|█▍        | 2.03G/14.4G [03:21<20:44, 10.7MB/s]Downloading:  15%|█▌        | 2.19G/14.4G [03:23<15:10, 14.4MB/s]Downloading:  15%|█▌        | 2.19G/14.4G [03:40<15:10, 14.4MB/s]Downloading:  16%|█▋        | 2.34G/14.4G [03:47<19:27, 11.1MB/s]Downloading:  17%|█▋        | 2.50G/14.4G [03:51<15:22, 13.8MB/s]Downloading:  18%|█▊        | 2.66G/14.4G [04:09<17:20, 12.1MB/s]Downloading:  20%|█▉        | 2.81G/14.4G [04:13<13:13, 15.7MB/s]Downloading:  20%|█▉        | 2.81G/14.4G [04:30<13:13, 15.7MB/s]Downloading:  21%|██        | 2.97G/14.4G [04:47<21:38, 9.44MB/s]Downloading:  22%|██▏       | 3.12G/14.4G [04:47<15:02, 13.4MB/s]Downloading:  22%|██▏       | 3.12G/14.4G [05:00<15:02, 13.4MB/s]Downloading:  23%|██▎       | 3.28G/14.4G [05:01<15:18, 13.0MB/s]Downloading:  24%|██▍       | 3.44G/14.4G [05:06<12:23, 15.8MB/s]Downloading:  24%|██▍       | 3.44G/14.4G [05:20<12:23, 15.8MB/s]Downloading:  25%|██▍       | 3.59G/14.4G [05:46<22:08, 8.72MB/s]Downloading:  26%|██▌       | 3.75G/14.4G [05:48<16:08, 11.8MB/s]Downloading:  27%|██▋       | 3.91G/14.4G [05:51<11:57, 15.7MB/s]Downloading:  28%|██▊       | 4.06G/14.4G [05:56<10:04, 18.3MB/s]Downloading:  28%|██▊       | 4.06G/14.4G [06:10<10:04, 18.3MB/s]Downloading:  29%|██▉       | 4.22G/14.4G [06:43<22:07, 8.22MB/s]Downloading:  30%|███       | 4.37G/14.4G [06:44<15:36, 11.5MB/s]Downloading:  32%|███▏      | 4.53G/14.4G [06:44<10:51, 16.2MB/s]Downloading:  33%|███▎      | 4.69G/14.4G [06:58<11:50, 14.6MB/s]Downloading:  33%|███▎      | 4.69G/14.4G [07:10<11:50, 14.6MB/s]Downloading:  34%|███▎      | 4.84G/14.4G [07:30<17:52, 9.55MB/s]Downloading:  35%|███▍      | 5.00G/14.4G [07:35<13:38, 12.3MB/s]Downloading:  36%|███▌      | 5.16G/14.4G [07:49<13:40, 12.1MB/s]Downloading:  37%|███▋      | 5.31G/14.4G [07:49<09:26, 17.2MB/s]Downloading:  37%|███▋      | 5.31G/14.4G [08:00<09:26, 17.2MB/s]Downloading:  38%|███▊      | 5.47G/14.4G [08:26<16:50, 9.47MB/s]Downloading:  39%|███▉      | 5.62G/14.4G [08:34<14:02, 11.2MB/s]Downloading:  40%|████      | 5.78G/14.4G [08:43<12:07, 12.7MB/s]Downloading:  41%|████▏     | 5.94G/14.4G [08:45<08:38, 17.5MB/s]Downloading:  41%|████▏     | 5.94G/14.4G [09:00<08:38, 17.5MB/s]Downloading:  42%|████▏     | 6.09G/14.4G [09:23<16:04, 9.23MB/s]Downloading:  43%|████▎     | 6.25G/14.4G [09:26<11:58, 12.1MB/s]Downloading:  45%|████▍     | 6.41G/14.4G [09:38<11:15, 12.7MB/s]Downloading:  46%|████▌     | 6.56G/14.4G [09:41<08:31, 16.4MB/s]Downloading:  46%|████▌     | 6.56G/14.4G [10:00<08:31, 16.4MB/s]Downloading:  47%|████▋     | 6.72G/14.4G [10:17<14:36, 9.39MB/s]Downloading:  48%|████▊     | 6.87G/14.4G [10:18<10:16, 13.1MB/s]Downloading:  48%|████▊     | 6.87G/14.4G [10:30<10:16, 13.1MB/s]Downloading:  49%|████▉     | 7.03G/14.4G [10:34<10:40, 12.3MB/s]Downloading:  50%|████▉     | 7.19G/14.4G [10:37<08:07, 15.8MB/s]Downloading:  50%|████▉     | 7.19G/14.4G [10:50<08:07, 15.8MB/s]Downloading:  51%|█████     | 7.34G/14.4G [11:15<14:00, 9.00MB/s]Downloading:  53%|█████▎    | 7.66G/14.4G [11:28<09:22, 12.8MB/s]Downloading:  54%|█████▍    | 7.81G/14.4G [11:34<07:59, 14.7MB/s]Downloading:  54%|█████▍    | 7.81G/14.4G [11:50<07:59, 14.7MB/s]Downloading:  55%|█████▌    | 7.97G/14.4G [12:05<11:14, 10.2MB/s]Downloading:  56%|█████▋    | 8.12G/14.4G [12:09<08:40, 12.9MB/s]Downloading:  56%|█████▋    | 8.12G/14.4G [12:20<08:40, 12.9MB/s]Downloading:  58%|█████▊    | 8.28G/14.4G [12:24<08:50, 12.3MB/s]Downloading:  59%|█████▊    | 8.44G/14.4G [12:32<07:41, 13.8MB/s]Downloading:  59%|█████▊    | 8.44G/14.4G [12:50<07:41, 13.8MB/s]Downloading:  60%|█████▉    | 8.59G/14.4G [13:00<10:14, 10.1MB/s]Downloading:  61%|██████    | 8.75G/14.4G [13:07<08:16, 12.2MB/s]Downloading:  61%|██████    | 8.75G/14.4G [13:20<08:16, 12.2MB/s]Downloading:  62%|██████▏   | 8.91G/14.4G [13:21<08:05, 12.1MB/s]Downloading:  63%|██████▎   | 9.06G/14.4G [13:25<06:17, 15.1MB/s]Downloading:  63%|██████▎   | 9.06G/14.4G [13:40<06:17, 15.1MB/s]Downloading:  64%|██████▍   | 9.22G/14.4G [13:51<08:28, 10.9MB/s]Downloading:  65%|██████▌   | 9.37G/14.4G [14:03<07:43, 11.6MB/s]Downloading:  66%|██████▋   | 9.53G/14.4G [14:16<07:11, 12.1MB/s]Downloading:  67%|██████▋   | 9.69G/14.4G [14:18<05:14, 16.0MB/s]Downloading:  67%|██████▋   | 9.69G/14.4G [14:30<05:14, 16.0MB/s]Downloading:  68%|██████▊   | 9.84G/14.4G [14:55<08:57, 9.06MB/s]Downloading:  70%|██████▉   | 10.0G/14.4G [14:59<06:36, 11.9MB/s]Downloading:  71%|███████   | 10.2G/14.4G [15:04<05:06, 14.8MB/s]Downloading:  72%|███████▏  | 10.3G/14.4G [15:14<04:44, 15.3MB/s]Downloading:  72%|███████▏  | 10.3G/14.4G [15:30<04:44, 15.3MB/s]Downloading:  73%|███████▎  | 10.5G/14.4G [15:54<08:10, 8.57MB/s]Downloading:  74%|███████▍  | 10.6G/14.4G [15:55<05:40, 11.8MB/s]Downloading:  75%|███████▍  | 10.8G/14.4G [15:57<03:57, 16.3MB/s]Downloading:  75%|███████▍  | 10.8G/14.4G [16:10<03:57, 16.3MB/s]Downloading:  76%|███████▌  | 10.9G/14.4G [16:10<04:06, 15.0MB/s]Downloading:  76%|███████▌  | 10.9G/14.4G [16:30<04:06, 15.0MB/s]Downloading:  77%|███████▋  | 11.1G/14.4G [16:40<05:56, 9.90MB/s]Downloading:  78%|███████▊  | 11.2G/14.4G [16:50<04:53, 11.5MB/s]Downloading:  78%|███████▊  | 11.2G/14.4G [17:00<04:53, 11.5MB/s]Downloading:  79%|███████▉  | 11.4G/14.4G [17:02<04:24, 12.1MB/s]Downloading:  80%|████████  | 11.6G/14.4G [17:06<03:17, 15.3MB/s]Downloading:  80%|████████  | 11.6G/14.4G [17:20<03:17, 15.3MB/s]Downloading:  81%|████████▏ | 11.7G/14.4G [17:28<04:04, 11.7MB/s]Downloading:  81%|████████▏ | 11.7G/14.4G [17:40<04:04, 11.7MB/s]Downloading:  83%|████████▎ | 11.9G/14.4G [17:49<04:22, 10.3MB/s]Downloading:  84%|████████▎ | 12.0G/14.4G [17:59<03:34, 11.8MB/s]Downloading:  85%|████████▍ | 12.2G/14.4G [18:08<03:01, 13.0MB/s]Downloading:  85%|████████▍ | 12.2G/14.4G [18:20<03:01, 13.0MB/s]Downloading:  86%|████████▌ | 12.3G/14.4G [18:20<02:44, 13.3MB/s]Downloading:  86%|████████▌ | 12.3G/14.4G [18:40<02:44, 13.3MB/s]Downloading:  87%|████████▋ | 12.5G/14.4G [18:41<03:00, 11.2MB/s]Downloading:  88%|████████▊ | 12.7G/14.4G [18:58<02:52, 10.7MB/s]Downloading:  89%|████████▉ | 12.8G/14.4G [18:59<01:52, 15.0MB/s]Downloading:  89%|████████▉ | 12.8G/14.4G [19:10<01:52, 15.0MB/s]Downloading:  90%|█████████ | 13.0G/14.4G [19:16<01:57, 13.0MB/s]Downloading:  90%|█████████ | 13.0G/14.4G [19:30<01:57, 13.0MB/s]Downloading:  91%|█████████▏| 13.1G/14.4G [19:30<01:47, 12.6MB/s]Downloading:  91%|█████████▏| 13.1G/14.4G [19:50<01:47, 12.6MB/s]Downloading:  92%|█████████▏| 13.3G/14.4G [19:50<01:48, 10.8MB/s]Downloading:  93%|█████████▎| 13.4G/14.4G [19:53<01:10, 14.3MB/s]Downloading:  93%|█████████▎| 13.4G/14.4G [20:10<01:10, 14.3MB/s]Downloading:  95%|█████████▍| 13.6G/14.4G [20:22<01:24, 9.99MB/s]Downloading:  96%|█████████▌| 13.7G/14.4G [20:26<00:52, 12.9MB/s]Downloading:  97%|█████████▋| 13.9G/14.4G [20:40<00:39, 12.8MB/s]Downloading:  97%|█████████▋| 13.9G/14.4G [20:44<00:44, 11.4MB/s]Downloading:  98%|█████████▊| 14.1G/14.4G [20:51<00:23, 14.2MB/s]Downloading:  99%|█████████▉| 14.2G/14.4G [21:03<00:11, 14.1MB/s]Downloading: 100%|█████████▉| 14.4G/14.4G [21:05<00:00, 19.3MB/s]Downloading: 100%|█████████▉| 14.4G/14.4G [21:05<00:00, 12.2MB/s]
Downloading:   0%|          | 0.00/2.44M [00:00<?, ?B/s]Downloading: 100%|██████████| 2.44M/2.44M [00:00<00:00, 4.23MB/s]Downloading: 100%|██████████| 2.44M/2.44M [00:00<00:00, 4.20MB/s]
Downloading:   0%|          | 0.00/2.44M [00:00<?, ?B/s]Downloading: 100%|██████████| 2.44M/2.44M [00:00<00:00, 4.38MB/s]Downloading: 100%|██████████| 2.44M/2.44M [00:00<00:00, 4.35MB/s]
Downloading:   0%|          | 0.00/302k [00:00<?, ?B/s]Downloading: 100%|██████████| 302k/302k [00:00<00:00, 2.44MB/s]Downloading: 100%|██████████| 302k/302k [00:00<00:00, 2.42MB/s]
Downloading:   0%|          | 0.00/615k [00:00<?, ?B/s]Downloading: 100%|██████████| 615k/615k [00:00<00:00, 3.06MB/s]Downloading: 100%|██████████| 615k/615k [00:00<00:00, 3.04MB/s]
Downloading:   0%|          | 0.00/15.1k [00:00<?, ?B/s]Downloading: 100%|██████████| 15.1k/15.1k [00:00<00:00, 466kB/s]
Downloading:   0%|          | 0.00/139k [00:00<?, ?B/s]Downloading: 100%|██████████| 139k/139k [00:00<00:00, 1.51MB/s]
Downloading:   0%|          | 0.00/196 [00:00<?, ?B/s]Downloading: 100%|██████████| 196/196 [00:00<00:00, 50.3kB/s]
Could not locate the tokenization_qwen.py inside /root/.cache/modelscope/hub/qwen/Qwen-7B-Chat.
Traceback (most recent call last):
  File "/mnt/VisDiff/serve/vlm_server_qwenvl.py", line 12, in <module>
    tokenizer = AutoTokenizer.from_pretrained(model_dir, trust_remote_code=True)
  File "/mnt/VisDiff/visdiff/lib/python3.9/site-packages/modelscope/utils/hf_util.py", line 113, in from_pretrained
    module_obj = module_class.from_pretrained(model_dir, *model_args,
  File "/mnt/VisDiff/visdiff/lib/python3.9/site-packages/transformers/models/auto/tokenization_auto.py", line 719, in from_pretrained
    tokenizer_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/mnt/VisDiff/visdiff/lib/python3.9/site-packages/transformers/dynamic_module_utils.py", line 485, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
  File "/mnt/VisDiff/visdiff/lib/python3.9/site-packages/transformers/dynamic_module_utils.py", line 292, in get_cached_module_file
    resolved_module_file = cached_file(
  File "/mnt/VisDiff/visdiff/lib/python3.9/site-packages/transformers/utils/hub.py", line 400, in cached_file
    raise EnvironmentError(
OSError: /root/.cache/modelscope/hub/qwen/Qwen-7B-Chat does not appear to have a file named tokenization_qwen.py. Checkout 'https://huggingface.co//root/.cache/modelscope/hub/qwen/Qwen-7B-Chat/None' for available files.
